{% comment %}
  Media Grid Hero Section
  -----------------------
  Layout: One large item (left) and two stacked smaller items (right).
  This uses CSS Grid and spans to achieve the exact alignment from the user's image.
  It is responsive, stacking blocks vertically on mobile.
{% endcomment %}

{% style %}
  /* --- BASE STYLES --- */
  .media-grid-{{ section.id }} {
    padding-top: 50px;
    padding-bottom: 50px;
    background-color: {{ section.settings.section_background }};
    font-family: sans-serif;
  }

  .grid-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 20px;
    display: grid;
    gap: 20px;


    /*
   Desktop Layout (3 columns, 2 rows for alignment)
   - Column 1 (Left Box) takes 2/3 of the width
   - Column 2 & 3 (Right Boxes) take 1/3 of the width combined
*/
    grid-template-columns: 2fr 1fr;
    grid-template-rows: repeat(2, minmax(250px, 1fr));
    /* Two equal rows for the right side */

    /* Ensure the large item spans both rows */
    grid-template-areas: "large small1" "large small2";
  }

  /* --- GRID ITEM STYLING --- */
  .grid-item {
    position: relative;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: {{ section.settings.grid_default_background }};
    color: {{ section.settings.grid_text_color }};
    min-height: 250px;
    transition: transform 0.3s ease;
  }

  .grid-item:hover {
    transform: scale(0.99);
  }

  .grid-item__content {
    position: relative;
    z-index: 10;
    text-align: center;
    padding: 20px;
    font-size: 1.8rem;
    font-weight: 500;
    text-transform: uppercase;
    letter-spacing: 3px;
  }

  /* Image/Content Overlays and Zoom */
  .grid-item__image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 4s ease-out;
  }

  .grid-item:hover .grid-item__image {
    transform: scale(1.05);
    /* Subtle zoom on hover */
  }

  .grid-item__overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.2);
    z-index: 5;
  }

  /* --- SPECIFIC GRID AREAS --- */
  .grid-item[data-position="0"] {
    grid-area: large;
  }
  .grid-item[data-position="1"] {
    grid-area: small1;
  }
  .grid-item[data-position="2"] {
    grid-area: small2;
  }

  /* --- HEADER STYLING --- */
  .section-heade {
    text-align: center;
    font-family: sans-serif;
    margin-bottom: 40px;
    letter-spacing: 5px;
    font-size: 25px;
    color: #333;
  }

  /* --- RESPONSIVENESS (Mobile/Tablet) --- */
  @media (max-width: 989px) {
    .grid-container {
      /* Revert to single-column layout on smaller screens */
      grid-template-columns: 1fr;
      grid-template-rows: auto;
      grid-template-areas: none;
      /* Reset grid areas */
    }

    .grid-item[data-position="0"],
    .grid-item[data-position="1"],
    .grid-item[data-position="2"] {
      grid-area: unset;
      /* Remove specific grid-area assignments */
      min-height: 350px;
      /* Ensure visual height on mobile */
    }

    .grid-item__content {
      font-size: 1.5rem;
      letter-spacing: 2px;
    }
  }

  /* Fallback color for text in case it's not set */
  a.grid-item {
    text-decoration: none;
  }
{% endstyle %}

<section class="media-grid-{{ section.id }}">
  <div class="section-heade">
    {% if section.settings.heading != blank %}
      {{ section.settings.heading | escape }}
    {% else %}
      MEDIA GRID
    {% endif %}
  </div>

  <div class="grid-container">
    {% assign blocks_to_render = section.blocks | where: 'type', 'grid_item' | slice: 0, 3 %}

    {% for block in blocks_to_render %}
      {% liquid
        assign block_image = block.settings.image
        assign overlay_opacity = block.settings.overlay_opacity | times: 0.01
        assign text_color = block.settings.text_color | default: section.settings.grid_text_color
        assign bg_color = block.settings.background_color | default: section.settings.grid_default_background
      %}

      <a
        href="{{ block.settings.link }}"
        class="grid-item"
        data-position="{{ forloop.index0 }}"
        {{ block.shopify_attributes }}
        style="
          background-color: {{ bg_color }};
          color: {{ text_color }};
        ">

        {% if block_image != blank %}
          <img
            class="grid-item__image"
            src="{{ block_image | image_url: width: 1000 }}"
            alt="{{ block.settings.title | escape }}"
            loading="lazy">
        {% endif %}

        <div class="grid-item__overlay" style="background-color: rgba(0, 0, 0, {{ overlay_opacity }});"></div>

        <div class="grid-item__content">
          {{ block.settings.title | default: "Grid Item " | append: forloop.index | escape }}
        </div>
      </a>
    {% endfor %}
  </div>
</section>

{% schema %}
  {
    "name": "Image Grid Hero",
    "tag": "section",
    "class": "section-media-grid-hero",
    "max_blocks": 3,
    "settings": [
      {
        "type": "text",
        "id": "heading",
        "label": "Section Heading",
        "default": "Media Grid"
      }, {
        "type": "color",
        "id": "section_background",
        "label": "Section Background",
        "default": "#F7F7F7"
      }, {
        "type": "color",
        "id": "grid_default_background",
        "label": "Default Grid BG Color",
        "default": "#000000"
      }, {
        "type": "color",
        "id": "grid_text_color",
        "label": "Default Text Color",
        "default": "#FFFFFF"
      }
    ],
    "blocks": [
      {
        "type": "grid_item",
        "name": "Grid Item",
        "settings": [
          {
            "type": "image_picker",
            "id": "image",
            "label": "Background Image"
          },
          {
            "type": "text",
            "id": "title",
            "label": "Title Text",
            "default": "WOMEN"
          },
          {
            "type": "url",
            "id": "link",
            "label": "Link",
            "default": "/collections/all"
          },
          {
            "type": "header",
            "content": "Customization (Optional)"
          }, {
            "type": "color",
            "id": "background_color",
            "label": "Background Color (Override)",
            "info": "Used if no image is set."
          }, {
            "type": "color",
            "id": "text_color",
            "label": "Text Color (Override)"
          }, {
            "type": "range",
            "id": "overlay_opacity",
            "min": 0,
            "max": 100,
            "step": 5,
            "unit": "%",
            "label": "Image Overlay Opacity",
            "default": 10
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Media Grid with Hero Layout",
        "blocks": [
          {
            "type": "grid_item",
            "settings": {
              "title": "WOMEN"
            }
          }, {
            "type": "grid_item",
            "settings": {
              "title": "MEN"
            }
          }, {
            "type": "grid_item",
            "settings": {
              "title": "ACCESSORIES"
            }
          }
        ]
      }
    ]
  }
{% endschema %}