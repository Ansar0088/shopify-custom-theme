{% comment %}
  SECTION: NEWSLETTER SUBSCRIPTION (Newsletter Section Code)

  This code is visually correct (black/white style) and avoids the
  color scheme error for this specific section by removing the setting
  from the schema block.
{% endcomment %}

{% assign overlay_color = section.settings.overlay_color | default: '#000000' %}
{% assign overlay_opacity = section.settings.overlay_opacity | divided_by: 100.0 %}

<style>
  /* Load Inter font */
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');

  /* --- General Section Styles --- */
  .section-{{ section.id }} {
    font-family: 'Inter'
    , sans-serif;
    position: relative;
    /* Section background hardcoded to black */
    background-color: #000000;
    /* All primary text is white */
    color: #FFFFFF;
    padding: 100px 20px;
    text-align: center;
    overflow: hidden;
  }

  {% if section.settings.separator %}
    .section-{{ section.id }} {
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }
  {% endif %}

  /* --- Background and Overlay --- */
  .newsletter-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    background-color: #000000;
  }

  .newsletter-background-image {
    width: 100%;
    height: 100%;
    object-fit: {{ section.settings.image_size }};
  }

  .newsletter-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: {{ overlay_color }};
    opacity: {{ overlay_opacity }};
    z-index: 2;
  }

  /* --- Content Box --- */
  .newsletter-content {
    position: relative;
    z-index: 3;
    max-width: 600px;
    margin: 0 auto;
  }

  /* --- Typography Styles --- */
  .newsletter-subheading {
    font-size: 0.75rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-bottom: 5px;
    color: #a0a0a0;
  }

  .newsletter-heading {
    font-size: 2.2rem;
    font-weight: 400;
    text-transform: uppercase;
    margin-bottom: 25px;
    color: #FFFFFF;
  }

  .newsletter-body {
    font-size: 0.95rem;
    line-height: 1.5;
    max-width: 450px;
    margin: 0 auto 35px;
    color: #FFFFFF;
  }

  /* --- Form Styles --- */
  .newsletter-form {
    display: flex;
    justify-content: center;
    gap: 15px;
    width: 100%;
  }

  .newsletter-input {
    flex-grow: 1;
    max-width: 300px;
    height: 48px;
    padding: 12px 15px;
    /* Input border set to White */
    border: 1px solid #FFFFFF;
    background-color: transparent;
    /* Input text color set to White */
    color: #FFFFFF;
    font-size: 0.95rem;
    transition: border-color 0.3s;
  }

  .newsletter-input:focus {
    outline: none;
    border-color: #FFFFFF;
  }

  .newsletter-input::placeholder {
    color: #777;
  }

  .newsletter-button {
    height: 48px;
    padding: 0 30px;
    /* Button border set to White */
    border: 1px solid #FFFFFF;
    /* Default white background */
    background-color: #FFFFFF;
    /* Default black text */
    color: #000000;
    font-size: 0.95rem;
    font-weight: 500;
    text-transform: uppercase;
    cursor: pointer;
    transition: background-color 0.3s
    , color 0.3s;
  }

  /* Button Hover State: Transparent background, white text/border */
  .newsletter-button:hover {
    background-color: transparent;
    color: #FFFFFF;
  }

  /* --- Mobile Responsiveness --- */
  @media (max-width: 600px) {
    .section-{{ section.id }} {
      padding: 70px 20px;
    }
    .newsletter-heading {
      font-size: 1.8rem;
    }
    .newsletter-body {
      font-size: 0.9rem;
      margin-bottom: 25px;
    }
    .newsletter-form {
      flex-direction: column;
      gap: 10px;
    }
    .newsletter-input,
    .newsletter-button {
      max-width: 100%;
      width: 100%;
    }
  }
</style>

<section class="section-{{ section.id }}">

  <div class="newsletter-background">
    {% if section.settings.image != blank %}
      {% assign desktop_image = section.settings.image %}
      {% assign mobile_image = section.settings.mobile_image | default: desktop_image %}

      <picture>
        {% if mobile_image != blank %}
          <source media="(max-width: 767px)" srcset="{{ mobile_image | img_url: '750x' }}">
        {% endif %}

        <img
          src="{{ desktop_image | img_url: '1500x' }}"
          alt="{{ section.settings.heading | escape }}"
          class="newsletter-background-image"
          loading="lazy">
      </picture>
    {% endif %}
  </div>
  <div class="newsletter-overlay"></div>

  <div class="newsletter-content">

    {% if section.settings.subheading != blank %}
      <p class="newsletter-subheading">
        {{ section.settings.subheading | escape }}
      </p>
    {% endif %}

    <h2 class="newsletter-heading">
      {{ section.settings.heading | escape }}
    </h2>

    {% if section.settings.content != blank %}
      <div class="newsletter-body">
        {{ section.settings.content }}
      </div>
    {% endif %}

    {% form 'customer' %}
      <input
        type="hidden"
        name="contact[tags]"
        value="newsletter">

      <div class="newsletter-form">
        <input
          type="email"
          name="contact[email]"
          id="NewsletterForm--{{ section.id }}"
          class="newsletter-input"
          value="{{ form.email }}"
          placeholder="E-mail"
          required
          aria-required="true"
          autocorrect="off"
          autocapitalize="off">
        <button
          type="submit"
          name="commit"
          id="Subscribe"
          class="newsletter-button">
          {{ section.settings.button_text | default: 'Subscribe' | escape }}
        </button>
      </div>

      {% comment %} Display success or error messages {% endcomment %}
      {% if form.posted_successfully? %}
        <p class="form-success" style="margin-top: 20px; color: #FFFFFF;">
          Thank you for subscribing!
        </p>
      {% elsif form.errors %}
        <p class="form-error" style="margin-top: 20px; color: #ff5555;">
          {{ form.errors | default_errors }}
        </p>
      {% endif %}

    {% endform %}

  </div>
</section>


{% schema %}
  {
    "name": "Newsletter",
    "tag": "section",
    "class": "section-newsletter",
    "settings": [
      {
        "type": "header",
        "content": "Text Content"
      },
      {
        "type": "text",
        "id": "subheading",
        "label": "Subheading",
        "default": "Keep me updated"
      },
      {
        "type": "text",
        "id": "heading",
        "label": "Heading",
        "default": "Newsletter"
      },
      {
        "type": "richtext",
        "id": "content",
        "label": "Short Description",
        "default": "<p>Subscribe to get notified about product launches, special offers and company news.</p>",
        "info": "This text appears just above the email input field."
      }, {
        "type": "text",
        "id": "button_text",
        "label": "Button text",
        "default": "Subscribe"
      }, {
        "type": "header",
        "content": "Background & Design"
      }, {
        "type": "checkbox",
        "id": "separator",
        "label": "Separate section with border",
        "default": false
      }, {
        "type": "image_picker",
        "id": "image",
        "label": "Desktop Background Image",
        "info": "2000 x 1000px recommended"
      }, {
        "type": "image_picker",
        "id": "mobile_image",
        "label": "Mobile Background Image",
        "info": "1100 x 1500px recommended. Default to desktop image."
      }, {
        "type": "select",
        "id": "image_size",
        "label": "Image size",
        "options": [
          {
            "value": "cover",
            "label": "Fit screen (Cover)"
          }, {
            "value": "contain",
            "label": "Original image ratio (Contain)"
          }, {
            "value": "auto",
            "label": "Original size (Auto)"
          }
        ],
        "default": "cover",
        "info": "Choose 'Original image ratio' to avoid image cropping."
      }, {
        "type": "color",
        "id": "overlay_color",
        "label": "Overlay color",
        "default": "#000000"
      }, {
        "type": "range",
        "id": "overlay_opacity",
        "min": 0,
        "max": 100,
        "step": 5,
        "unit": "%",
        "label": "Overlay opacity",
        "default": 0
      }
    ],
    "presets": [
      {
        "name": "Newsletter Signup",
        "category": "Marketing"
      }
    ]
  }
{% endschema %}