<style>
  /* --- Section Styles --- */
  .section-{{ section.id }} {
    background-color: var(--color-background);
    color: var(--color-primary-text);
    padding: 60px 20px;
    font-size: {{ settings.font_size_base }}px;
  }

  {% if section.settings.separator %}
    .section-{{ section.id }} {
      border-top: 1px solid var(--color-border);
    }
  {% endif %}

  /* --- Grid Layout --- */
  .icon-grid-wrapper {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    max-width: 1200px;
    margin: 0 auto;
    text-align: {{ section.settings.text_alignment | default: 'center' }};
  }

  /* --- Individual Column Block --- */
  .icon-grid-block {
    flex: 0 0 25%;
    max-width: 25%;
    padding: 20px;
    margin-bottom: 30px;
    box-sizing: border-box;
  }

  /* --- Content Alignment --- */
  .icon-grid-block__content {
    display: flex;
    flex-direction: column;
    align-items: {% if section.settings.text_alignment == 'left' %}flex-start{% elsif section.settings.text_alignment == 'right' %}flex-end{% else %}center{% endif %};
  text-align: {{ section.settings.text_alignment | default: 'center' }};
}

/* --- Icon Styling --- */
.icon-grid-block__icon {
  width: {{ section.settings.icon_width | default: 50 }}px;
  height: {{ section.settings.icon_width | default: 50 }}px;
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.icon-grid-block__icon svg {
  width: 100%;
  height: 100%;
}

.icon-grid-block__icon img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

/* Icon color handling - Use theme colors */
.icon-grid-block__icon svg path,
.icon-grid-block__icon svg circle,
.icon-grid-block__icon svg rect,
.icon-grid-block__icon svg polygon {
  fill: var(--color-secondary-text);
  stroke: var(--color-secondary-text);
}

/* If specific icon color is set, override with that */
{% if section.settings.icon_color != 'theme' %}
  .icon-grid-block__icon svg path,
  .icon-grid-block__icon svg circle,
  .icon-grid-block__icon svg rect,
  .icon-grid-block__icon svg polygon {
    fill: {{ section.settings.icon_color }};
    stroke: {{ section.settings.icon_color }};
  }
{% endif %}

/* --- Text Styling --- */
.icon-grid-block__heading {
  font-size: {{ settings.font_size_small | default: settings.font_size_base | times: 0.85 | round }}px;
  font-weight: {{ settings.font_weight_medium | default: 500 }};
  text-transform: uppercase;
  letter-spacing: 1px;
  margin-bottom: 5px;
  color: var(--color-header-text);
}

/* If specific text color is set, override with that */
{% if section.settings.text_color != 'theme' %}
  .icon-grid-block__heading {
    color: {{ section.settings.text_color }};
  }
{% endif %}

.icon-grid-block__content-text {
  font-size: {{ settings.font_size_small | default: settings.font_size_base | times: 0.8 | round }}px;
  line-height: {{ settings.body_line_height | default: 1.6 }};
  color: var(--color-primary-text);
  margin-top: 5px;
}

/* Apply theme font families */
.section-{{ section.id }},
.icon-grid-block__heading,
.icon-grid-block__content-text {
  {% if settings.font_body %}
    font-family: {{ settings.font_body.family }}, 
    {{ settings.font_body.fallback_families }};
  {% endif %}
}

/* Apply heading font family to headings */
.icon-grid-block__heading {
  {% if settings.font_heading %}
    font-family: {{ settings.font_heading.family }}, 
    {{ settings.font_heading.fallback_families }};
  {% endif %}
}

/* --- Mobile Responsiveness --- */
@media (max-width: 749px) {
  .section-{{ section.id }} {
    padding: 40px 10px;
  }

  .icon-grid-block {
    flex: 0 0 50%;
    max-width: 50%;
    padding: 15px;
    margin-bottom: 20px;
  }

  .icon-grid-block__icon {
    width: {{ section.settings.mobile_icon_width | default: 35 }}px;
    height: {{ section.settings.mobile_icon_width | default: 35 }}px;
    margin-bottom: 10px;
  }

  .icon-grid-block__heading {
    font-size: {{ settings.font_size_small | default: settings.font_size_base | times: 0.75 | round }}px;
  }

  .icon-grid-block__content-text {
    font-size: {{ settings.font_size_small | default: settings.font_size_base | times: 0.75 | round }}px;
  }
}

/* For extra small screens */
@media (max-width: 480px) {
  .icon-grid-block {
    flex: 0 0 100%;
    max-width: 100%;
  }
}

/* Custom CSS from settings */
{%- if section.settings.custom_css != blank -%}
  {{ section.settings.custom_css }}
{%- endif -%}
</style>

<section class="section-{{ section.id }} color-{{ section.settings.color_scheme.id | default: settings.color_schemes.first.id }}">
  <div class="icon-grid-wrapper">
    {% for block in section.blocks %}
      <div class="icon-grid-block" {{ block.shopify_attributes }}>
        <div class="icon-grid-block__content">

          {% comment %} ICON HANDLING {% endcomment %}
          <div class="icon-grid-block__icon">
            {% if block.settings.custom_icon != blank %}
              {% comment %} Custom uploaded image icon {% endcomment %}
              <img
                src="{{ block.settings.custom_icon | image_url: width: 128 }}"
                loading="lazy"
                alt="{{ block.settings.heading | escape }}"
                width="{{ section.settings.icon_width | default: 50 }}"
                height="{{ section.settings.icon_width | default: 50 }}">
            {% elsif block.settings.icon != 'none' %}
              {% comment %} Pre-defined SVG icon from Shopify's icon library {% endcomment %}
              {% case block.settings.icon %}
                {% when 'truck' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <path
                      d="M10 17h6V6a1 1 0 00-1-1H4a1 1 0 00-1 1v11a1 1 0 001 1h2"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M16 17h4a1 1 0 001-1v-4"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M20 8h2l1 3 1 3h-3"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <circle
                      cx="7.5"
                      cy="17.5"
                      r="2.5"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <circle
                      cx="17.5"
                      cy="17.5"
                      r="2.5"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'box' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <path
                      d="M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M3.27 6.96L12 12.01l8.73-5.05"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M12 22.08V12"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'shield' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <path
                      d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'credit-card' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <rect
                      x="1"
                      y="4"
                      width="22"
                      height="16"
                      rx="2"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M1 10h22"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'star' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <polygon
                      points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'gift' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <rect
                      x="3"
                      y="8"
                      width="18"
                      height="4"
                      rx="1"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M12 8v13"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <rect
                      x="8"
                      y="4"
                      width="8"
                      height="4"
                      rx="1"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M8 12v9"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M16 12v9"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'clock' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <circle
                      cx="12"
                      cy="12"
                      r="10"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M12 6v6l4 2"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'phone' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <path
                      d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'mail' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <path
                      d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M22 6l-10 7L2 6"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'check-circle' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <path
                      d="M22 11.08V12a10 10 0 11-5.93-9.14"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M22 4L12 14.01l-3-3"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'leaf' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <path
                      d="M11 20A7 7 0 013.6 5.6a7 7 0 0110.2 0A7 7 0 0111 20z"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M11 20v-7"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'award' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <circle
                      cx="12"
                      cy="8"
                      r="7"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M8.21 13.89L7 23l5-3 5 3-1.21-9.11"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'heart' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <path
                      d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'lock' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <rect
                      x="3"
                      y="11"
                      width="18"
                      height="11"
                      rx="2"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M7 11V7a5 5 0 0110 0v4"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% when 'refresh' %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <path
                      d="M23 4v6h-6"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M1 20v-6h6"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
                {% else %}
                  {% comment %} Default icon if none matches {% endcomment %}
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none">
                    <circle
                      cx="12"
                      cy="12"
                      r="10"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M12 16v-4"
                      stroke="currentColor"
                      stroke-width="1.5" />
                    <path
                      d="M12 8h.01"
                      stroke="currentColor"
                      stroke-width="1.5" />
                  </svg>
              {% endcase %}
            {% endif %}
          </div>

          <h3 class="icon-grid-block__heading">
            {{ block.settings.heading | default: "Feature" | escape }}
          </h3>

          <div class="icon-grid-block__content-text">
            {{ block.settings.content | default: "Description text goes here" }}
          </div>

        </div>
      </div>
    {% endfor %}
  </div>
</section>

{% schema %}
  {
    "name": "Text with Icon Grid",
    "tag": "section",
    "class": "section-text-icon-grid",
    "settings": [
      {
        "type": "header",
        "content": "Color Scheme"
      },
      {
        "type": "color_scheme",
        "id": "color_scheme",
        "label": "Color scheme",
        "default": "scheme_1"
      },
      {
        "type": "checkbox",
        "id": "separator",
        "label": "Separate section with border",
        "default": false
      },
      {
        "type": "select",
        "id": "text_alignment",
        "label": "Text alignment",
        "options": [
          {
            "value": "left",
            "label": "Left"
          }, {
            "value": "center",
            "label": "Center"
          }, {
            "value": "right",
            "label": "Right"
          }
        ],
        "default": "center"
      }, {
        "type": "select",
        "id": "icon_color",
        "label": "Icon color",
        "options": [
          {
            "value": "theme",
            "label": "Use theme color"
          },
          {
            "value": "#333333",
            "label": "Dark"
          },
          {
            "value": "#555555",
            "label": "Medium Gray"
          },
          {
            "value": "#777777",
            "label": "Light Gray"
          }, {
            "value": "#000000",
            "label": "Black"
          }, {
            "value": "#ffffff",
            "label": "White"
          }
        ],
        "default": "theme"
      }, {
        "type": "select",
        "id": "text_color",
        "label": "Text color",
        "options": [
          {
            "value": "theme",
            "label": "Use theme color"
          },
          {
            "value": "#333333",
            "label": "Dark"
          },
          {
            "value": "#555555",
            "label": "Medium Gray"
          },
          {
            "value": "#777777",
            "label": "Light Gray"
          }, {
            "value": "#000000",
            "label": "Black"
          }, {
            "value": "#ffffff",
            "label": "White"
          }
        ],
        "default": "theme"
      }, {
        "type": "header",
        "content": "Layout"
      }, {
        "type": "range",
        "id": "icon_width",
        "min": 20,
        "max": 100,
        "step": 5,
        "unit": "px",
        "label": "Icon width",
        "default": 50
      }, {
        "type": "range",
        "id": "mobile_icon_width",
        "min": 15,
        "max": 60,
        "step": 5,
        "unit": "px",
        "label": "Mobile icon width",
        "default": 35
      }, {
        "type": "header",
        "content": "Custom CSS"
      }, {
        "type": "textarea",
        "id": "custom_css",
        "label": "Custom CSS",
        "info": "Add custom styles for this section."
      }
    ],
    "blocks": [
      {
        "type": "icon_item",
        "name": "Text with Icon",
        "settings": [
          {
            "type": "header",
            "content": "Icon"
          },
          {
            "type": "select",
            "id": "icon",
            "label": "Icon",
            "options": [
              {
                "value": "truck",
                "label": "Truck"
              },
              {
                "value": "box",
                "label": "Box"
              },
              {
                "value": "shield",
                "label": "Shield"
              },
              {
                "value": "credit-card",
                "label": "Credit Card"
              }, {
                "value": "star",
                "label": "Star"
              }, {
                "value": "gift",
                "label": "Gift"
              }, {
                "value": "clock",
                "label": "Clock"
              }, {
                "value": "phone",
                "label": "Phone"
              }, {
                "value": "mail",
                "label": "Mail"
              }, {
                "value": "check-circle",
                "label": "Check Circle"
              }, {
                "value": "leaf",
                "label": "Leaf"
              }, {
                "value": "award",
                "label": "Award"
              }, {
                "value": "heart",
                "label": "Heart"
              }, {
                "value": "lock",
                "label": "Lock"
              }, {
                "value": "refresh",
                "label": "Refresh"
              }, {
                "value": "none",
                "label": "No Icon"
              }
            ],
            "default": "star"
          },
          {
            "type": "image_picker",
            "id": "custom_icon",
            "label": "Custom icon (optional)",
            "info": "Upload an image to override the selected icon. 128 x 128px .png recommended."
          },
          {
            "type": "header",
            "content": "Text"
          }, {
            "type": "text",
            "id": "heading",
            "label": "Heading",
            "default": "Feature Heading"
          }, {
            "type": "textarea",
            "id": "content",
            "label": "Content",
            "default": "Feature description text goes here"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Text with Icon Grid",
        "category": "Text",
        "blocks": [
          {
            "type": "icon_item",
            "settings": {
              "icon": "truck",
              "heading": "Free Shipping",
              "content": "Free delivery on all orders over $50"
            }
          }, {
            "type": "icon_item",
            "settings": {
              "icon": "shield",
              "heading": "Secure Payment",
              "content": "100% secure payment processing"
            }
          }, {
            "type": "icon_item",
            "settings": {
              "icon": "clock",
              "heading": "24/7 Support",
              "content": "Round-the-clock customer support"
            }
          }, {
            "type": "icon_item",
            "settings": {
              "icon": "check-circle",
              "heading": "Money Back",
              "content": "30 day money back guarantee"
            }
          }
        ]
      }
    ],
    "max_blocks": 8
  }
{% endschema %}